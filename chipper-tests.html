<!DOCTYPE HTML>
<!-- Top-level HTML file for chipper generated by 'grunt generate-development-html' -->
<html>
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1"/>
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="phet-sim-level" content="development">
  <link rel="stylesheet" href="../sherpa/lib/qunit-2.20.0.css">
  <title>chipper</title>
</head>

<!-- body is only made black for the loading phase so that the splash screen is black -->
<body>
<div id="qunit"></div>
<div id="qunit-fixture"></div>

<script type="text/javascript">
  /* eslint-disable quotes, quote-props */

  window.phet = window.phet || {};
  window.phet.chipper = window.phet.chipper || {};
  window.phet.chipper.packageObject =
    {
      "name": "chipper",
      "version": "2.0.0",
      "license": "MIT",
      "repository": {
        "type": "git",
        "url": "https://github.com/phetsims/chipper.git"
      },
      "scripts": {
        "test": "bash ../perennial-alias/bin/sage run ../perennial-alias/node_modules/qunit/bin/qunit.js js/test/chipper-tests.ts",
        "test-long": "bash ../perennial-alias/bin/sage run ../perennial-alias/node_modules/qunit/bin/qunit.js js/test/*",
        "test-string-keys": "bash ../perennial-alias/bin/sage run js/scripts/assertNoMissingMainEnStringKeys.ts",
        "test-deprecated-string-keys": "bash ../perennial-alias/bin/sage run js/scripts/assertAllDeprecatedStringKeysUsed.ts"
      },
      "phet": {
        "chipperSupportsOutputJSGruntTasks": true,
        "supportsOutputJS": true,
        "published": true,
        "generatedUnitTests": true
      },
      "devDependencies": {
        "@babel/preset-env": "~7.21.4",
        "@swc/cli": "~0.5.2",
        "@swc/core": "~1.10.1",
        "@types/js-yaml": "~4.0.9",
        "@types/lodash": "~4.14.172",
        "@types/express": "~5.0.1",
        "@types/serve-index": "^1.9.4",
        "archiver": "~5.3.0",
        "chokidar": "~3.5.1",
        "docdash": "~1.2.0",
        "esbuild": "~0.25.0",
        "expose-loader": "~4.1.0",
        "express": "~4.21.2",
        "grunt": "~1.5.3",
        "html-webpack-plugin": "~5.3.2",
        "jimp": "~0.16.1",
        "jpeg-js": "~0.4.3",
        "js-yaml": "~4.1.0",
        "jsdoc": "~4.0.4",
        "lodash": "~4.17.21",
        "marked": "~4.0.1",
        "modify-source-webpack-plugin": "~4.1.0",
        "node-html-encoder": "~0.0.2",
        "pako": "~2.0.4",
        "pngjs": "~6.0.0",
        "serve-index": "^1.9.1",
        "svgo": "~3.2.0",
        "taffydb": "~2.7.3",
        "terser": "~4.6.4",
        "webpack": "~5.95.0",
        "webpack-cli": "~5.0.0"
      }
    };
  window.phet.chipper.stringRepos =
    [
      {
        "repo": "joist",
        "requirejsNamespace": "JOIST"
      },
      {
        "repo": "scenery-phet",
        "requirejsNamespace": "SCENERY_PHET"
      },
      {
        "repo": "sun",
        "requirejsNamespace": "SUN"
      },
      {
        "repo": "tambo",
        "requirejsNamespace": "TAMBO"
      },
      {
        "repo": "twixt",
        "requirejsNamespace": "TWIXT"
      }
    ];
  window.phet.chipper.allowLocaleSwitching = true;

  // Identify the brand (assume generated brand if not provided with query parameters)
  const brandMatch = location.search.match( /brand=([^&]+)/ );
  const brand = brandMatch ? decodeURIComponent( brandMatch[ 1 ] ) : 'adapted-from-phet';

  // Preloads, with more included for phet-io brand
  let preloads = [
    '../sherpa/lib/jquery-2.1.0.js',
    '../sherpa/lib/lodash-4.17.4.js',
    '../sherpa/lib/FileSaver-b8054a2.js',
    '../sherpa/lib/linebreak-1.1.0.js',
    '../sherpa/lib/flatqueue-1.2.1.js',
    '../sherpa/lib/paper-js-0.12.17.js',
    '../sherpa/lib/he-1.1.1.js',
    '../assert/js/assert.js',
    '../query-string-machine/js/QueryStringMachine.js',
    '../chipper/js/browser/initialize-globals.js',
    '../sherpa/lib/seedrandom-2.4.2.js',
    '../sherpa/lib/base64-js-1.2.0.js',
    '../sherpa/lib/TextEncoderLite-3c9f6f0.js',
    '../sherpa/lib/qunit-2.20.0.js',
    '../chipper/js/browser/sim-tests/qunit-connector.js'
  ];

  const query = new URLSearchParams( window.location.search );
  const esbuild = !!query.has( 'esbuild' );
  const liveReload = !!query.has( 'liveReload' );

  // RichText imports himalaya but it is skipped by esbuild, so we add it as a preload here.
  // see https://github.com/phetsims/scenery/issues/1583 and https://github.com/phetsims/chipper/issues/1409 and https://github.com/phetsims/membrane-transport/issues/6#issuecomment-2631403462
  if ( esbuild ) {
    preloads.push( '../sherpa/lib/himalaya-1.1.0.js' );
  }

  if ( brand === 'phet-io' ) {
    preloads = preloads.concat( [
      '../phet-io/js/phet-io-initialize-globals.js'
    ] );
  }

  // Loads a synchronously-executed asynchronously-downloaded script tag, with optional data-main parameter.
  // See http://www.html5rocks.com/en/tutorials/speed/script-loading/ for more about script loading. It helps to
  // load all of the scripts with this method, so they are treated the same (and placed in the correct execution
  // order).
  const loadURL = ( preloadURL, type = 'text/javascript' ) => {
    const script = document.createElement( 'script' );
    script.type = type;
    script.src = preloadURL;
    script.async = false;
    script.setAttribute( 'crossorigin', 'use-credentials' );
    document.head.appendChild( script );
  };

  // Kick off string loading immediately
  loadURL( '../chipper/js/browser/load-unbuilt-strings.js' );

  // Queue all of the preloads to be loaded.
  preloads.forEach( preload => loadURL( preload ) );

  const targetSource = esbuild ? '../chipper/dist/dev-server-runnable/chipper.js' : '../chipper/dist/js/chipper/js/browser/chipper-tests.js';

  // Module loading in compilation-free (development) mode will be kicked off once strings are loaded.
  // This is done in load-unbuilt-strings.js
  window.phet.chipper.loadModules = () => loadURL( targetSource, 'module' );

    // Live reload, see https://esbuild.github.io/api/#live-reload
  if ( liveReload ) {
    new EventSource( '/esbuild' ).addEventListener( 'change', () => location.reload() );
  }
</script>
</body>
</html>