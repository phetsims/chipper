<!DOCTYPE HTML>
<!-- Top-level HTML file for {{REPOSITORY}} generated by 'grunt generate-development-html' -->
<html>
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1"/>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="phet-sim-level" content="development">
{{STYLESHEETS}}
  <title>{{BROWSER_WINDOW_TITLE}}</title>
</head>

<!-- body is only made black for the loading phase so that the splash screen is black -->
<body{{BODYSTYLE}}>
{{BODYSTART}}

<script type="text/javascript">
  /*eslint-disable quotes, quote-props*/

  window.phet = window.phet || {};
  window.phet.chipper = window.phet.chipper || {};
  window.phet.chipper.packageObject =
    {{PACKAGE_OBJECT}};
  window.phet.chipper.stringRepos =
    {{STRING_REPOS}};
  window.phet.chipper.allowLocaleSwitching = true;

  // Identify the brand (assume generated brand if not provided with query parameters)
  const brandMatch = location.search.match( /brand=([^&]+)/ );
  const brand = brandMatch ? decodeURIComponent( brandMatch[ 1 ] ) : 'adapted-from-phet';

  // Preloads, with more included for phet-io brand
  let preloads = {{PRELOADS}};

  if ( brand === 'phet-io' ) {
    preloads = preloads.concat( {{PHET_IO_PRELOADS}} );
  }

  // Loads a synchronously-executed asynchronously-downloaded script tag, with optional data-main parameter.
  // See http://www.html5rocks.com/en/tutorials/speed/script-loading/ for more about script loading. It helps to
  // load all of the scripts with this method, so they are treated the same (and placed in the correct execution
  // order).
  const loadURL = ( preloadURL, type = 'text/javascript' ) => {
    const script = document.createElement( 'script' );
    script.type = type;
    script.src = preloadURL;
    script.async = false;
    script.setAttribute( 'crossorigin', 'use-credentials' );
    document.head.appendChild( script );
  };

  // Kick off string loading immediately
  loadURL( '../chipper/js/load-unbuilt-strings.js' );

  // Queue all of the preloads to be loaded.
  preloads.forEach( preload => loadURL( preload ) );

  // Module loading in compilation-free (development) mode will be kicked off once strings are loaded.
  // This is done in load-unbuilt-strings.js
  // eslint-disable-next-line bad-sim-text
  window.phet.chipper.loadModules = () => loadURL( '{{MAIN_FILE}}', 'module' );
</script>
</body>
</html>